/*! For license information please see qlikmetrics.0b5ab5f0dde8f917aaf5.js.LICENSE.txt */
/*!
 * sense-client@7.144.6
 * 
 * Copyright(C) 2021 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[10],{T26u:function(e,t,n){!function(t,n){true;e.exports=n();var r,i}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){e.exports=function(){var e=e||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){var t=t,n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var a=i(4294967296*(n||e.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new s.init(r,t)}}),a=r.enc={},u=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},f=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=4*o,u=i/a,c=(u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*o,f=e.min(4*c,i);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(r,l);var d=r.splice(0,c);n.sigBytes-=f}return new s.init(d,f)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(i.Hasher=l.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math);return e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectMerge=t.isLocalStorageAvailable=t.createSession=t.generateId=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){return e&&e.__esModule?e:{default:e}}(n(8));var s=t.generateId=o.default;t.createSession=function(){return(new Date).getTime()+"_"+s()},t.isLocalStorageAvailable=function(){try{return window.localStorage.setItem("is this","supported?"),window.localStorage.removeItem("is this"),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==window.localStorage.length}},t.objectMerge=function(e,t){var n=e||{},o=t||{};return Object.keys(n).reduce((function(e,t){return"object"===i(n[t])?e[t]=r({},n[t],o[t]):e[t]=void 0===o[t]?n[t]:o[t],e}),{})}},function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=a(e),t=u(t);var n=this.map[e];this.map[e]=n?n+","+t:t},f.prototype.delete=function(e){delete this.map[a(e)]},f.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},f.prototype.set=function(e,t){this.map[a(e)]=u(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),c(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),c(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),c(e)},t.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];m.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=v,e.Response=m,e.fetch=function(e,n){return new Promise((function(r,i){var o=new v(e,n),s=new XMLHttpRequest;s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:function(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;r(new m(t,e))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&t.blob&&(s.responseType="blob"),o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),s.send(void 0===o._bodyInit?null:o._bodyInit)}))},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function h(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=p(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=d(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(e,t){var n=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return o.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function g(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function m(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.location=function(){return{origin:function(){if(!window.location.origin){var e=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+e}return window.location.origin}(),pathname:window.location.pathname}},t.system=function(){return{language:navigator.language,platform:navigator.platform,referrer:document.referrer,screen:{devicePixelRatio:window.devicePixelRatio,height:window.screen.height,width:window.screen.width},timezoneOffset:(new Date).getTimezoneOffset(),userAgent:navigator.userAgent}}},function(e,t,n){e.exports=function(e){return function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.algo,a=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),u[i]=n(t.pow(r,1/3)),i++),r++}();var c=[],f=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],f=n[5],l=n[6],d=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var p=c[h-15],y=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,v=c[h-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[h]=y+c[h-7]+g+c[h-16]}var m=r&i^r&o^i&o,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&f^~a&l)+u[h]+c[h];d=l,l=f,f=a,a=s+w|0,s=o,o=i,i=r,r=w+(b+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+f|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(f),n.HmacSHA256=o._createHmacHelper(f)}(Math),e.SHA256}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=d(n(6)),a=d(n(15)),u=d(n(16)),c=d(n(17)),f=n(1),l=n(3);function d(e){return e&&e.__esModule?e:{default:e}}var h={apiKey:"",mouseTracker:{enable:!1,timer:500},integrationId:"",productInfo:void 0},p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.configure=this.configure.bind(this),this.setPropOnEvents=this.setPropOnEvents.bind(this),this.setupDataHandler=this.setupDataHandler.bind(this),this.setupListeners=this.setupListeners.bind(this),this.start=this.start.bind(this),this.trackEvent=this.trackEvent.bind(this);var n=(0,f.objectMerge)(h,t);this.setupDataHandler(n)}return o(e,[{key:"configure",value:function(t){var n=(0,f.objectMerge)(this.config||h,t);if(this.config){if(!e.validateConfig(n))return;this.config=n,this.setupListeners()}else this.setupDataHandler(n)}}]),o(e,[{key:"setPropOnEvents",value:function(e,t){this.dataHandler&&this.dataHandler.setCustomProp(e,t)}},{key:"setupDataHandler",value:function(t){if(e.validateConfig(t)){this.config=t;var n=this.config,r=n.apiKey,i=n.integrationId,o=n.productInfo;this.dataHandler=new s.default({apiKey:r,integrationId:i,productInfo:o})}}},{key:"setupListeners",value:function(){if(this.config){var e=this.config.mouseTracker;this.loadTracker.addListener(),this.mousemoveTracker.addListener(i({},e))}}},{key:"start",value:function(e){if(this.dataHandler){var t=this.dataHandler.addLocalStorageToBackupQueue;this.eventTracker=new a.default(this.dataHandler),this.loadTracker=new u.default(t),this.mousemoveTracker=new c.default(this.trackEvent),"function"==typeof e&&e(),this.setupListeners(),this.trackEvent("sessionStarted",(0,l.system)(),"qlikmetricsEvent")}}},{key:"trackEvent",value:function(e,t,n){this.eventTracker&&this.eventTracker.trackEvent(e,t,n)}}],[{key:"validateConfig",value:function(e){if(!e)return!1;var t=e.apiKey,n=e.integrationId,i=e.productInfo;return!(!t||t.length<=1)&&!(!n||n.length<=1)&&(!i||!Array.isArray(i)&&"object"===(void 0===i?"undefined":r(i)))}}]),e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),s=n(1),a=f(n(11)),u=n(3),c=f(n(12));function f(e){return e&&e.__esModule?e:{default:e}}var l=["eventCategory","eventName","location","qlikmetricsId","qlikmetricsVersion","properties","sessionId","timestamp"],d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addLocalStorageToBackupQueue=this.addLocalStorageToBackupQueue.bind(this),this.addToBackupQueue=this.addToBackupQueue.bind(this),this.getSQS=this.getSQS.bind(this),this.sendBackupQueueToLocalStorage=this.sendBackupQueueToLocalStorage.bind(this),this.sendBackupQueueToSQS=this.sendBackupQueueToSQS.bind(this),this.sendMessage=this.sendMessage.bind(this),this.sendMessageToSQS=this.sendMessageToSQS.bind(this),this.setCustomProp=this.setCustomProp.bind(this),this.setupIds=this.setupIds.bind(this),this.backupQueue=[],this.config=t,this.customProps={},this.envInfo={},this.localStorageKey="backupQueue";var n=this.config,r=n.apiKey,i=n.integrationId,o=n.productInfo;this.credentialsHandler=new a.default({apiKey:r,integrationId:i,productInfo:o}),this.setupIds()}return i(e,[{key:"addLocalStorageToBackupQueue",value:function(){if((0,s.isLocalStorageAvailable)()){var e=JSON.parse(window.localStorage.getItem(this.localStorageKey));e&&(this.backupQueue=this.backupQueue.concat(e),window.localStorage.removeItem(this.localStorageKey))}}},{key:"addToBackupQueue",value:function(e){this.backupQueue.every((function(t){return e.timestamp!==t.timestamp}))&&this.backupQueue.push(e)}},{key:"getSQS",value:function(){var e=this;return this.sqs?Promise.resolve(this.sqs):this.credentialsHandler.getCredentials().then((function(t){var n=t.accessKeyId,r=t.queueUrl,i=t.region,o=t.secretAccessKey,s=t.sessionToken,a=t.deploymentEnv,u=t.packagingEnv,f=t.productVersion;return e.sqs=new c.default({accessKeyId:n,apiVersion:"2012-11-05",region:i,secretAccessKey:o,sessionToken:s}),e.envInfo={deploymentEnv:a,packagingEnv:u,productVersion:f},e.queueUrl=r,e.sqs}))}},{key:"sendMessage",value:function(e){var t=this,n=r({location:(0,u.location)()},e,{qlikmetricsId:this.qlikmetricsId,qlikmetricsVersion:"2.0.0",sessionId:this.sessionId,timestamp:(new Date).getTime()},this.customProps);return this.sendMessageToSQS(n).then((function(){return t.sendBackupQueueToSQS()})).catch((function(){t.addToBackupQueue(n),t.sendBackupQueueToLocalStorage()}))}},{key:"sendMessageToSQS",value:function(e){var t=this;return this.getSQS().then((function(n){return new Promise((function(i,o){var s={DelaySeconds:10,MessageBody:JSON.stringify(r({},e,t.envInfo)),QueueUrl:t.queueUrl};n.sendMessage(s,(function(e,t){e?o(e):i(t.MessageId)}))}))})).catch((function(e){throw"InvalidClientTokenId"!==e.Code&&"ExpiredToken"!==e.Code||(t.sqs=void 0),e}))}},{key:"sendBackupQueueToLocalStorage",value:function(){if(!(0,s.isLocalStorageAvailable)())return!1;if(0!==this.backupQueue.length)try{window.localStorage.setItem(this.localStorageKey,JSON.stringify(this.backupQueue))}catch(e){window.localStorage.removeItem(this.localStorageKey);try{window.localStorage.setItem(this.localStorageKey,JSON.stringify(this.backupQueue))}catch(e){return!1}}return!0}},{key:"sendBackupQueueToSQS",value:function(){for((0,s.isLocalStorageAvailable)()&&window.localStorage.removeItem(this.localStorageKey);0!==this.backupQueue.length;)this.sendMessageToSQS(this.backupQueue.pop())}},{key:"setCustomProp",value:function(e,t){e&&"string"==typeof e&&-1===l.indexOf(e)&&void 0!==t&&(this.customProps[e]=t)}},{key:"setupIds",value:function(){var e=(0,o.getQlikmetricsIdCookie)();""===e&&(e=(0,s.generateId)(),(0,o.createQlikmetricsIdCookie)(e)),this.qlikmetricsId=e,this.sessionId=(0,s.createSession)()}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQlikmetricsIdCookie=function(){for(var e="qlikmetricsId=",t=document.cookie.split(";"),n=0;n<t.length;n+=1){for(var r=t[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""},t.createQlikmetricsIdCookie=function(e){var t=new Date;t.setFullYear(t.getFullYear()+2),document.cookie="qlikmetricsId="+e+";Expires="+t+";"}},function(e,t,n){var r=n(9),i=n(10);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(2);var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.getCredentials=this.getCredentials.bind(this)}return r(e,[{key:"getCredentials",value:function(){var e=this;if(this.fetchingCredentials)return Promise.reject({name:"FetchingCredentials"});this.fetchingCredentials=!0;var t=this.config,n=t.apiKey,r=t.integrationId,i=t.productInfo,o={headers:{Accept:"application/json","x-api-key":n}};return i&&(o.headers["x-product-info"]=JSON.stringify(i)),fetch("https://api.qlikdataengineering.com/sqs-proxy/v1/"+r+"/credentials",o).then((function(e){return e.json()})).then((function(t){return e.fetchingCredentials=!1,t})).catch((function(t){throw e.fetchingCredentials=!1,t}))}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(2);var i=s(n(13)),o=s(n(4));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t}return r(e,[{key:"authorizationHeader",value:function(e,t){var n=this.config,r=n.accessKeyId,i=n.region,o="AWS4-HMAC-SHA256 Credential="+r+"/"+e.substring(0,8)+"/"+i+"/sqs/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date;x-amz-security-token, Signature="+t;return o}}]),r(e,[{key:"messageParams",value:function(e){var t=this.config.apiVersion,n=e.DelaySeconds,r=e.MessageBody,i=e.QueueUrl;return"Action=SendMessage&DelaySeconds="+n+"&MessageBody="+encodeURIComponent(r)+"&QueueUrl="+i+"&Version="+t}},{key:"sendMessage",value:function(e,t){var n=e.QueueUrl,r=this.config.sessionToken,i=n.match(/^(?:https?:)?(?:\/\/)?([^/?]+)/)[1];if(i){var s=this.messageParams(e),a=(0,o.default)(s),u=((new Date).toISOString().split(".")[0]+"Z").replace(/-/g,"").replace(/:/g,""),c={host:i,origin:"https://"+i},f=this.signature(c.host,a,u),l=this.authorizationHeader(u,f);fetch(c.origin,{body:s,headers:{Accept:"application/json",Authorization:l,"Content-Type":"application/x-www-form-urlencoded","X-Amz-Content-Sha256":a,"X-Amz-Date":u,"X-Amz-Security-Token":r},method:"POST"}).then((function(e){return e.json()})).then((function(e){e.SendMessageResponse?t(void 0,e.SendMessageResponse.SendMessageResult):e.Error&&t(e.Error,void 0)})).catch((function(e){return t(e,void 0)}))}}},{key:"signature",value:function(e,t,n){var r=this.config,s=r.sessionToken,a=r.region,u="POST\n/\n\nhost:"+e+"\nx-amz-content-sha256:"+t+"\nx-amz-date:"+n+"\nx-amz-security-token:"+s+"\n\nhost;x-amz-content-sha256;x-amz-date;x-amz-security-token\n"+t,c=(0,o.default)(u).toString(),f="AWS4-HMAC-SHA256\n"+n+"\n"+n.substring(0,8)+"/"+a+"/sqs/aws4_request\n"+c,l=this.signatureKey(n),d=(0,i.default)(f,l).toString();return d}},{key:"signatureKey",value:function(e){var t=this.config,n=t.region,r=t.secretAccessKey,o=e.substring(0,8),s=(0,i.default)(o,"AWS4"+r),a=(0,i.default)(n,s),u=(0,i.default)("sqs",a);return(0,i.default)("aws4_request",u)}}]),e}();t.default=a},function(e,t,n){e.exports=function(e){return e.HmacSHA256}(n(0),n(4),n(14))},function(e,t,n){e.exports=function(e){!function(){var t=e,n=t.lib,r=n.Base,i=t.enc,o=i.Utf8,s=t.algo;s.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),a=i.words,u=s.words,c=0;c<n;c++)a[c]^=1549556828,u[c]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);t.reset();var r=t.finalize(this._oKey.clone().concat(n));return r}})}()}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trackEvent=this.trackEvent.bind(this),this.dataHandler=t}return i(e,[{key:"trackEvent",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={eventCategory:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",eventName:t,properties:n};e.validateMessageBody(r)&&this.dataHandler.sendMessage(r)}}],[{key:"validateMessageBody",value:function(e){return!!e.eventName&&!(e.eventName.length<=1)&&"object"===r(e.properties)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addListener=this.addListener.bind(this),this.removeListener=this.removeListener.bind(this),this.addLocalStorageToBackupQueue=t}return r(e,[{key:"addListener",value:function(){var e=this;this.removeListener(),this.listener=function(){e.addLocalStorageToBackupQueue()},window.addEventListener("load",this.listener,!0)}},{key:"removeListener",value:function(){this.listener&&window.removeEventListener("load",this.listener,!0)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addListener=this.addListener.bind(this),this.eventListener=this.eventListener.bind(this),this.removeListener=this.removeListener.bind(this),this.points=[],this.trackEvent=t}return r(e,[{key:"addListener",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.removeListener();var t=e.enable,n=e.timer;t&&(this.timer=n,window.addEventListener("mousemove",this.eventListener,!0))}},{key:"eventListener",value:function(e){var t=this;clearTimeout(this.timeout);var n=e.pageX,r=e.pageY,i=e.timeStamp;this.points.push({pageX:n,pageY:r,timeStamp:i}),this.timeout=setTimeout((function(){var e=document.body,n=e.scrollHeight,r=e.scrollWidth,i={points:t.points,documentHeight:n,documentWidth:r};t.points=[],t.trackEvent("mousemove",i,"qlikmetricsEvent")}),this.timer)}},{key:"removeListener",value:function(){window.removeEventListener("mousemove",this.eventListener,!0)}}]),e}();t.default=i}]).default}))}}]);